{
    "hosting": {
        "predeploy": "npm run build",
        "public": "server/build",
        "ignore": [
            "firebase.json",
            "**/.*"
        ],
        "redirects": [
            {
                "source": "/images/:path*",
                "destination": "/esm-bundled/images/:path*",
                "type": 301
            }
        ],
        "rewrites": [
            {
                "source": "/api/talkies/dialogflow",
                "function": "DialogflowHandler"
            },
            {
                "source": "/api/talkies/raw",
                "function": "TalkieAPIHandler"
            },
            {
                "source": "/api/inbound-email",
                "function": "EmailReceiveHandler"
            },
            {
                "source": "/api/inbound-email-authorize",
                "function": "EmailSPFHandler"
            },
            {
                "source": "/service-worker.js",
                "destination": "/esm-bundled/service-worker.js"
            },
            {
                "source": "/firebase-messaging-sw.js",
                "destination": "/esm-bundled/firebase-messaging-sw.js"
            },
            {
                "source": "**",
                "function": "PrplHandler"
            }
        ],
        "headers": [
            {
                "source" : "**/service-worker.js",
                "headers" : [
                    {
                        "key" : "Service-Worker-Allowed",
                        "value" : "/"
                    },
                    {
                        "key": "Cache-Control",
                        "value": "no-cache"
                    }
                ]
            },
            {
                "source" : "**/firebase-messaging-sw.js",
                "headers" : [
                    {
                        "key" : "Service-Worker-Allowed",
                        "value" : "/"
                    },
                    {
                        "key": "Cache-Control",
                        "value": "no-cache"
                    }
                ]
            }
        ]
    },
    "functions": {
        "predeploy": "npm run build && npm --prefix functions run build"
    }
}